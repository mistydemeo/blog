<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[The Future Is Now]]></title>
  <link href="http://mistys-internet.website/blog/atom.xml" rel="self"/>
  <link href="http://mistys-internet.website/blog/"/>
  <updated>2015-06-23T20:13:10-07:00</updated>
  <id>http://mistys-internet.website/blog/</id>
  <author>
    <name><![CDATA[Misty De Meo]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Release: Asuka 120% Limit Over English Translation]]></title>
    <link href="http://mistys-internet.website/blog/blog/2015/06/21/release-asuka-120-percent-limit-over-english-translation/"/>
    <updated>2015-06-21T21:36:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2015/06/21/release-asuka-120-percent-limit-over-english-translation</id>
    <content type="html"><![CDATA[<p>Asuka 120% Limited was a 1997 fighting game for the Sega Saturn, the final<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> game in a long-running series. The Asuka 120% games were always underdog favourites of mine; despite looking like throwaway anime fan-pandering, they were surprisingly deep, innovative games with unique mechanics that paved the way for later, more famous games like Guilty Gear and X-Men vs Street Fighter.</p>

<p><img class="right" src="http://mistys-internet.website/blog/images/asuka/cover.gif" title="Asuka 120% Limit Over cover art" >
In 1999, an unofficial mod titled <a href="http://www5.ocn.ne.jp/~afc/limitover/index.html">Asuka 120% Limit Over</a> was released. <a href="http://asuka-120.wikia.com/wiki/Asuka_120%25_Limited_BURNING_Fest.">Rumoured</a> to have been made by the original developers, Limit Over is a surprisingly polished update with many refinements and new gameplay mechanics. It went ignored by the English internet for many years, until the patch was discovered in 2007 by <a href="http://forums.lostlevels.org/viewtopic.php?t=1233">Lost Levels forum posters</a>; it&rsquo;s now also circulating as a prepatched ISO.</p>

<p>Even though there isn&rsquo;t much text, Limit Over is hard to play without knowing Japanese, so I&rsquo;ve prepared a translation patch.</p>

<h2>The patch</h2>

<p><img src="http://mistys-internet.website/blog/images/asuka/kiyoko_vs_cathy.png" title="Kiyoko vs Cathy screenshot" >
<img src="http://mistys-internet.website/blog/images/asuka/nana_vs_tamaki.png" title="Nana vs Tamaki screenshot" ></p>

<p><a href="http://mistys-internet.website/blog/data/asuka_120_lo_english_10.zip">Asuka 120% Limit Over English patch, version 1.0</a></p>

<p>This patch is compatible with the final release of Limit Over for the Saturn<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>. In order to use it, you need to have already built or obtained a disc image of Limit Over. The patch includes two options: a <a href="http://web.archive.org/web/20061016073657/http://www.paradogs.com/pdx_ppf2.htm">PPF</a> disc image patch, or individual patches for each file on the disc that was changed. Detailed installation instructions are included in the ZIP file.</p>

<p>For more on what&rsquo;s been translated, and how it was done, read on.</p>

<h2>Graphics</h2>

<p>Limit Over contains very little text, almost all of it in English. Unfortunately, though, one critical thing is in Japanese: the character names. Since the barebones menus have no graphics, not even character portraits, it&rsquo;s very difficult to actually play without knowing Japanese. Have any idea who you&rsquo;re picking in the screenshot below? I don&rsquo;t&hellip;</p>

<p><img src="http://mistys-internet.website/blog/images/asuka/Japanesecharacterselect.png" title="Japanese character select screen" ></p>

<p>A few other minor bits of text are stored in Japanese: the &ldquo;N characters beaten&rdquo; text in ranking and deathmatch modes, and the round start and round end graphics. Their meaning is obvious without being able to read them, however, so I decided to leave them alone.</p>

<h3>Finding the tiles</h3>

<p>Like most games of this era, Asuka 120%&rsquo;s graphics are stored as sets of fixed-size tiles with a set, non-true colour palette. Since these are generally stored as raw pixel data without any form of header, it can be tricky to figure out where the tiles are and how they&rsquo;re stored; fortunately, however, there are many good <a href="http://www.romhacking.net/?page=utilities&amp;category=10&amp;platform=&amp;game=&amp;author=&amp;os=&amp;level=&amp;perpage=20&amp;title=&amp;desc=&amp;utilsearch=Go">tile editors</a> available that simplify the task.</p>

<p><img src="http://mistys-internet.website/blog/images/asuka/CrystalTile.png" title="Crystal Tile 2" ></p>

<p>I used a free Windows tile editor called <a href="http://www.romhacking.net/utilities/818/">Crystal Tile 2</a>, pictured above, which has some very useful features, including presets for a large number of common tile formats, support for arbitrary tile size, and the ability to import and export tiles to PNG. <img class="right" src="http://mistys-internet.website/blog/images/asuka/Debug.png" width="200" title="Yabause debug output" > Via trial and error, and with help from information gleaned via the <a href="http://yabause.org/">Yabause</a> emulator&rsquo;s debug mode, pictured right, I was able to locate three copies of the character name tiles in the TTLDAT.SSP<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>, V_GAGE.SSP and VS_SPR.SSP files. The latter two files are used to store the in-battle user interface and the menus, respectively.</p>

<p><img class="left" src="http://mistys-internet.website/blog/images/asuka/AsukaJapanesename.png" title="Asuka Japanese name tile" ></p>

<p>Each character name is a 4 bits per pixel 72x24<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup> tile and, fortunately, Crystal Tile&rsquo;s &ldquo;N64/MD 4bpp&rdquo; preset supports them perfectly. After configuring the palette in Crystal Tile I exported every name to a set of 13 PNG files, like the tile to the left.</p>

<h3>Editing</h3>

<p>I redrew the text using a highly-edited version of a font lovingly stolen from the Neo-Geo game <a href="http://www.neogeosoft.com/?section=view&amp;game=pnyaa">Pochi &amp; Nyaa</a>. Compared to other fonts I looked at, it had the advantage of being both attractive and variable-width&mdash;which is important since the English names (which take up at least twice as many characters as the original Japanese) were very hard to fit in a width of 72 pixels. I also expanded the size of the characters compared to the original.</p>

<p><img class="right" src="http://mistys-internet.website/blog/images/asuka/AsukaEnglishthin.png" title="Asuka name, with thin letters" >
<img class="right" src="http://mistys-internet.website/blog/images/asuka/AsukaEnglishthick.png" title="Asuka name, with thick letters" ></p>

<p>I briefly experimented with a thin variation of the character names for use in the game&rsquo;s menus, but abandoned it after determining legibility was poor; the menus are 480i, and the flicker inherent in an interlaced image on a CRT or a deinterlaced image rendered the thinner lines harder to read than necessary. To the right are the thick and thin variations of the main character&rsquo;s name.</p>

<h2>Text</h2>

<p>The rest of the game&rsquo;s menu text is stored as ASCII strings in the main executable, and is completely in English. I did, however, make several changes to the character names displayed during loading screens. The one American character&rsquo;s name, Cathy, was misromanized as &ldquo;Cachy&rdquo;. This is an easy mistake to make, since her name was rendered in Japanese as &ldquo;きゃしい&rdquo; (Kyashii)<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup>. I also changed the romanization of several characters&#8217; names from <a href="https://en.wikipedia.org/wiki/Kunrei-shiki_romanization">Kunrei-shiki</a> (Sinobu, Tetuko, Genitiro) to the more familiar <a href="https://en.wikipedia.org/wiki/Hepburn_romanization">Hepburn</a> (Shinobu, Tetsuko, Genichirou).</p>

<h2>What&rsquo;s new in Limit Over?</h2>

<p>It&rsquo;s been many years since I&rsquo;ve played Limited, so this list is based on my imperfect memory.</p>

<ul>
<li>Every character has been rebalanced, and every single one of the core game mechanics has been refined.</li>
<li>Every character now has three strengths of normals and special moves instead of two.</li>
<li>A dodge button has been added, allowing characters to sidestep out of attacks.</li>
<li>Many characters have new special or super moves.</li>
</ul>

<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>The original developer, Fill-in-Cafe, went bankrupt after Limited was released in 1997, but a mediocre sequel and PC port were released in 1999 by another company.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>The only version readily available on the internet is dated &ldquo;12/31&rdquo;; I&rsquo;ve heard there were earlier versions, but I&rsquo;ve never seen them.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>This file is probably unused in Limit Over, since there is no graphical title screen.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>Except the tile for Genichirou, which is so long it&rsquo;s allocated two tiles.<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
<li id="fn:5">
<p>Cathy&rsquo;s name is rendered in Hiragana despite being a foreign name; it would more normally be rendered as &ldquo;キャシー&rdquo;.<a href="#fnref:5" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Attack the Vector]]></title>
    <link href="http://mistys-internet.website/blog/blog/2015/05/16/attack-the-vector/"/>
    <updated>2015-05-16T21:12:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2015/05/16/attack-the-vector</id>
    <content type="html"><![CDATA[<p>One downside of working with ancient OSs is coming across bugs that will never be fixed.</p>

<p>In the early days of Tigerbrew, I had just started experimenting with GCC 4.2 as a replacement for Xcode 2.5&rsquo;s GCC 4.0. Everything was going great until I built something that uses Cocoa, which blew up with this message:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>In file included from /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.framework/Headers/DriverServices.h:32,
</span><span class='line'>                 from /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.framework/Headers/CarbonCore.h:125,
</span><span class='line'>                 from /System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:21,
</span><span class='line'>                 from test.c:2:
</span><span class='line'>/System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.framework/Headers/MachineExceptions.h:115: error: expected specifier-qualifier-list before ‘vector’</span></code></pre></td></tr></table></div></figure>


<p>A syntax error coming not from within the package I was building, but from within&hellip; Carbon?</p>

<p>The error actually comes from the Vector128 union within MachineExceptions.h, located in CoreServices&rsquo;s CarbonCore framework. The very first section of this union had the offending code. Let&rsquo;s play spot the bug:</p>

<p>Here&rsquo;s what it looks like as of OS X 10.4.11:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">typedef</span> <span class="k">struct</span> <span class="n">FPUInformationPowerPC</span>    <span class="n">FPUInformationPowerPC</span><span class="p">;</span>
</span><span class='line'><span class="k">union</span> <span class="n">Vector128</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#ifdef __VEC__</span>
</span><span class='line'> <span class="n">vector</span> <span class="kt">unsigned</span> <span class="kt">int</span>         <span class="n">v</span><span class="p">;</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">long</span>       <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">short</span>      <span class="n">s</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">char</span>       <span class="n">c</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>And here it is in OS X 10.7.5<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">typedef</span> <span class="k">struct</span> <span class="n">FPUInformationPowerPC</span>    <span class="n">FPUInformationPowerPC</span><span class="p">;</span>
</span><span class='line'><span class="k">union</span> <span class="n">Vector128</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#ifdef __APPLE_ALTIVEC__</span>
</span><span class='line'>   <span class="n">vector</span> <span class="kt">unsigned</span> <span class="kt">int</span>         <span class="n">v</span><span class="p">;</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">long</span>       <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">short</span>      <span class="n">s</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">char</span>       <span class="n">c</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>The bug comes from the use of the <code>vector</code> keyword. As pointed out in this <a href="https://trac.macports.org/ticket/34213#comment:7">MacPorts ticket</a>, the issue is with the <code>#ifdef</code> that checks for <code>__VEC__</code>. <code>__VEC__</code> is defined if AltiVec is on, <em>without necessarily</em> meaning that AltiVec syntactic extensions are enabled. The <code>vector</code> keyword is only available if either <code>altivec.h</code> is included, or the <code>-mpim-altivec</code> or <code>-faltivec</code> flags are passed. Since Tigerbrew always optimizes for the host CPU, G4 and G5 users were getting AltiVec enabled without forcing syntactic extensions. I fixed this in Tigerbrew this by always passing <code>-faltivec</code> on PowerPC systems when building any package, regardless of whether AltiVec is being used.</p>

<p>As to why Apple never caught this, GCC 4.0&rsquo;s behaviour seems to be different; it seems to enable AltiVec syntactic extensions whenever <code>-maltivec</code> is on. Apple did eventually fix the bug, as seen in the Lion header above. According to the MacPorts ticket linked previously, it was fixed in the CarbonCore header in 10.5 and in the 10.4u SDK packaged in Xcode 3 for Leopard. Since the 10.4u SDK fix was never backported to Tiger itself, Tiger users have to make do with the workaround.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>10.7 may be Intel-only, but the relevant code&rsquo;s still there. In fact, the same PowerPC unions and structs are still there as of 10.9.4.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Reevaluate]]></title>
    <link href="http://mistys-internet.website/blog/blog/2015/05/02/reevaluate/"/>
    <updated>2015-05-02T10:41:08-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2015/05/02/reevaluate</id>
    <content type="html"><![CDATA[<p>My least favourite backtrace is a backtrace that doesn&rsquo;t include my own code.</p>

<p>Tigerbrew on OS X 10.4 uses <a href="http://mistys-internet.website/blog/blog/2013/04/02/adventures-with-ruby-1-8-2/">Ruby 1.8.2</a>, which was shipped on Christmas Day, 2004, and it has more than its fair share of interesting bugs. In today&rsquo;s lesson we break Ruby&rsquo;s stdlib class OpenStruct.</p>

<p>OpenStruct is a simple data structure that provides a JavaScript object-like interface to Ruby hashes. It&rsquo;s essentially a hash that provides getter and setter methods for each defined attribute. For example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">os</span> <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">os</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>
</span><span class='line'><span class="n">os</span><span class="o">.</span><span class="n">key</span> <span class="c1">#=&gt; &#39;value&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Homebrew uses OpenStruct instances in place of hashes in code which only performs reading and writing of attributes, without using any other hash features. For example, in the <a href="https://github.com/Homebrew/homebrew/blob/8b35d842ec1d5e54418024e8afa4fa4ba4302eeb/Library/Homebrew/cmd/deps.rb#L6-L12"><code>deps</code> command</a>, OpenStruct is used for read-only access to a set of attributes read from ARGV:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">mode</span> <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
</span><span class='line'>  <span class="ss">:installed?</span>  <span class="o">=&gt;</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;--installed&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="ss">:tree?</span>       <span class="o">=&gt;</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;--tree&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="ss">:all?</span>        <span class="o">=&gt;</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;--all&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="ss">:topo_order?</span> <span class="o">=&gt;</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;-n&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="ss">:union?</span>      <span class="o">=&gt;</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;--union&#39;</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">mode</span><span class="o">.</span><span class="n">installed?</span> <span class="o">&amp;&amp;</span> <span class="n">mode</span><span class="o">.</span><span class="n">tree?</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first time I ran <code>brew deps</code> in Tigerbrew, however, I was greeted with this lovely backtrace:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>SyntaxError: (eval):3:in `instance_eval&#39;: compile error
</span><span class='line'>(eval):3: syntax error
</span><span class='line'>        def topo_order?=(x); @table[:topo_order?] = x; end
</span><span class='line'>                       ^
</span><span class='line'>(eval):3: syntax error
</span><span class='line'>    from /usr/lib/ruby/1.8/ostruct.rb:72:in `instance_eval&#39;
</span><span class='line'>    from /usr/lib/ruby/1.8/ostruct.rb:72:in `instance_eval&#39;
</span><span class='line'>    from /usr/lib/ruby/1.8/ostruct.rb:72:in `new_ostruct_member&#39;
</span><span class='line'>    from /usr/lib/ruby/1.8/ostruct.rb:51:in `initialize&#39;
</span><span class='line'>    from /usr/lib/ruby/1.8/ostruct.rb:49:in `each&#39;
</span><span class='line'>    from /usr/lib/ruby/1.8/ostruct.rb:49:in `initialize&#39;
</span></code></pre></td></tr></table></div></figure>


<p>Given that the backtrace includes only stdlib code and nothing I wrote, I wasn&rsquo;t sure how to interpret this until I saw &ldquo;(eval)&rdquo;. It couldn&rsquo;t be, could it&hellip;? Of course it was.</p>

<p>Accessors for attribute of OpenStruct instances are methods, and they are defined by OpenStruct a) whenever a new attribute is assigned, and b) when OpenStruct is initialized with a hash. This is achieved using the method <code>OpenStruct#new_ostruct_member</code><sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, which was <a href="https://github.com/ruby/ruby/blob/eed0809a08bf5d2c28349b12c23a33101b7d648e/lib/ostruct.rb#L70-L77">defined like this</a> in Ruby 1.8.2:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">new_ostruct_member</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>  <span class="k">unless</span> <span class="nb">self</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">instance_eval</span> <span class="sx">%{</span>
</span><span class='line'><span class="sx">      def </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="sx">; @table[:</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="sx">]; end</span>
</span><span class='line'><span class="sx">      def </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="sx">=(x); @table[:</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="sx">] = x; end</span>
</span><span class='line'><span class="sx">    }</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Yes: OpenStruct dynamically defines method names by interpolating the name of the variable into a string and evaluating the string in the context of the object. Unsurprisingly, this is very fragile. In our example, the attributes being defined end with a question mark; <code>#installed?</code> is a valid method name in Ruby, but <code>#installed?=</code> is not, and so a SyntaxError exception is raised inside <code>eval</code>.</p>

<p>This was eventually fixed<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>; in <a href="https://github.com/ruby/ruby/blob/a9721a259665149b1b9ff0beabcf5f8dc0136120/lib/ostruct.rb#L166-L174">Ruby 2.2.2&rsquo;s definition</a>, the <code>#define_singleton_method</code> method is used instead; metaprogramming is not limited to the normal naming restrictions, so the unusual setters are defined properly<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">new_ostruct_member</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">name</span> <span class="o">=</span> <span class="nb">name</span><span class="o">.</span><span class="n">to_sym</span>
</span><span class='line'>  <span class="k">unless</span> <span class="nb">respond_to?</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>    <span class="n">define_singleton_method</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span> <span class="p">{</span> <span class="vi">@table</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">define_singleton_method</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">modifiable</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="n">x</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="nb">name</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Thankfully, the definiton of the method from modern versions of Ruby is fully compatible with Ruby 1.8.2, so Tigerbrew ships with <a href="https://github.com/mistydemeo/tigerbrew/blob/b63d347ab995697fb54bcaa5bfc75d1865d5e573/Library/Homebrew/extend/tiger.rb#L37-L56">a backported version of <code>OpenStruct#new_ostruct_member</code></a>.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>This sounds like it should be a private method, and is <a href="http://ruby-doc.org/stdlib-1.9.3/libdoc/ostruct/rdoc/OpenStruct.html#method-i-new_ostruct_member">documented</a> as being &ldquo;used  internally&rdquo;, but for some reason this was a public instance method right up until <a href="https://github.com/ruby/ruby/commit/2dafb0f47a7ae70362aea7649b635e97bb33dcf2">Ruby 2.0</a>.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p><a href="https://github.com/ruby/ruby/commit/48653d5ef0ed47469d64170d70c8c2a9f21f159e">Close to a year</a> after Ruby 1.8.2 was released.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>These illegal method names can&rsquo;t be called using the normal syntax, but they can be called via metaprogramming using the <a href="http://ruby-doc.org/core-2.2.2/Object.html#method-i-send"><code>#send</code></a> instance method, e.g. <code>os.send "foo?=", "baz"</code><a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Widescreen Gaming in the 90s]]></title>
    <link href="http://mistys-internet.website/blog/blog/2015/01/02/widescreen-gaming-in-the-90s/"/>
    <updated>2015-01-02T14:02:49-08:00</updated>
    <id>http://mistys-internet.website/blog/blog/2015/01/02/widescreen-gaming-in-the-90s</id>
    <content type="html"><![CDATA[<p>Most people got their first taste of widescreen gaming with the Wii, Xbox 360, and PS3, but not a lot of people know that companies were experimenting with widescreen all the way back in the fifth console generation (PS1, Saturn, N64). A tiny number of games have full widescreen support, which looks great on modern widescreen TVs.</p>

<h2>Anamorphic widescreen</h2>

<p>(Skip to the next section if you just care about pretty pictures!)</p>

<p>Since there isn&rsquo;t a widescreen resolution in the SDTV standards, all widescreen games used a technique called <a href="https://en.wikipedia.org/wiki/Anamorphic_widescreen">anamorphic widescreen</a><sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. In anamorphic widescreen, the game squeezes down a 16:9 scene into 4:3; the TV then stretches the 4:3 image back out to 16:9 for display. For example, take a look at this image from Christmas Nights:</p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Nights_3_wide_unscaled.png"></p>

<p>You can see that the proportions on everything are too thin&mdash;it&rsquo;s very noticeable on Claris. Here&rsquo;s what it looks like stretched out:</p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Nights_2_wide.png"></p>

<p>This shows you a lot more of the game world than you&rsquo;d get in the standard 4:3 mode, but you can see that all of the 2D elements in the scene are displayed with the wrong aspect ratio. This lack of aspect ratio correction for 2D elements is common to most widescreen games of that era. In Nights, for example, you can see that the interface elements and all 2D in-game elements (the tree, the stars in the upper left corner) are displayed at the wrong aspect ratio when playing in widescreen. This hurts some games more than others.<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></p>

<h2>Examples</h2>

<h3>Christmas Nights</h3>

<p>Both Christmas Nights and Nights support native widescreen. This is probably one of the most famous widescreen games of the era.</p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Nights_1_narrow.png"></p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Nights_2_wide.png"></p>

<p>Nights benefits enormously from a wider field of view, even though it uses a lot of sprites. Being able to see more of where you&rsquo;re going makes for a much better game.</p>

<h3>Panzer Dragoon Zwei</h3>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Panzer_1_narrow.png"></p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Panzer_2_wide.png"></p>

<p>Like Nights, Panzer Zwei has a similar field of view in either mode, with more content displayed on the sides.</p>

<h3>Baroque</h3>

<p>This is an obscure game, but Baroque&rsquo;s spare, gritty low-poly nightmarish landscapes are some of the most beautiful and haunting I&rsquo;ve ever seen. It reminds me a lot of <a href="http://cicadamarionette.com/">Lilith</a>&rsquo;s dreamscapes, like <a href="http://lilithzone.itch.io/oneiric-gardens">Oneiric Gardens</a> and <a href="http://cicadamarionette.com/Games/CryptWorlds/Main.html">Crypt Worlds</a>.</p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Baroque_1_narrow.png"></p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Baroque_2_wide.png"></p>

<p>Baroque makes heavy use of sprites; all of the game&rsquo;s NPCs and enemies are sprites in a 3D space. Unfortunately, that makes it look worse in widescreen than the other games I&rsquo;ve written about.</p>

<h3>Virtua Fighter (32X)</h3>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Virtua_1_narrow.png"></p>

<p><img src="http://mistys-internet.website/blog/images/widescreen/Virtua_2_wide.png"></p>

<p>This game&rsquo;s almost entirely 3D, so it scales very well; the only major 2D element is the 2D background.</p>

<h2>More</h2>

<p>A more complete list of widescreen games of this generation is available on the <a href="http://www.sega-16.com/forum/showthread.php?25942-5th-Generation-Games-List-Playing-in-Widescreen">Sega-16 forums</a>.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>This is the same technique used by widescreen DVDs and Wii games.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>I&rsquo;ve focused on Sega games for this post; I haven&rsquo;t checked to see whether PS1 or N64 games have the same aspect ratio issues with sprites.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Homebrew GCC Changes Coming]]></title>
    <link href="http://mistys-internet.website/blog/blog/2014/12/05/homebrew-gcc-changes-coming/"/>
    <updated>2014-12-05T18:57:06-08:00</updated>
    <id>http://mistys-internet.website/blog/blog/2014/12/05/homebrew-gcc-changes-coming</id>
    <content type="html"><![CDATA[<p>Big GCC changes are a-coming to <a href="http://brew.sh">Homebrew</a>, which will make building your own software against Homebrew-provided GCCs much more reliable. There&rsquo;s going to be a transition period, though, and any software built against GCC will need to be rebuilt against the new package to work. We&rsquo;ll be pushing the changes on <strong>December 12th, 2014</strong>, and this post is here to help you get ready for it!</p>

<p>(This only affects software built using Homebrew&rsquo;s GCC. Any software built using Clang, which is the compiler that Apple ships, will be unaffected. If you don&rsquo;t know what this means: you&rsquo;re probably fine.)</p>

<h2>The problem</h2>

<p>Since Apple provides many of the same libraries as GCC, Homebrew installs GCC to a nonstandard location in order to avoid shadowing those libraries. Homebrew currently installs GCC using the <code>--enable-version-specific-runtime-libs</code> option to sandbox its libraries and headers, which installs libraries into versioned locations like so:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/usr/local/lib/gcc/x86_64-apple-darwin13.4.0/4.9.2/libgfortran.3.dylib</span></code></pre></td></tr></table></div></figure>


<p>Since the full version of GCC is embedded&mdash;including the minor version&mdash;along with the OS version, every minor release is installed to a new location; this breaks any software which has dynamically linked against a previous GCC version&rsquo;s copies of these libraries.</p>

<h2>What&rsquo;s changing</h2>

<p>The new GCC package we are shipping will install GCC libraries to a path containing only the series version of GCC. For example, libgfortran will now be installed to:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/usr/local/lib/gcc/4.9/libgfortran.3.dylib</span></code></pre></td></tr></table></div></figure>


<p>This has several advantages:</p>

<ul>
<li>New releases of GCC 4.9 will be installed to the same path, so software built using GCC 4.9.2 will work with software built using GCC 4.9.3.</li>
<li>The same changes will be applied to the <code>gcc49</code> formula in the <a href="https://github.com/Homebrew/homebrew-versions/">homebrew/versions</a> repository, allowing <code>gcc49</code> to provide the 4.9 libraries when <code>gcc</code> is eventually upgraded to 5.0.</li>
</ul>


<h2>What you need to do</h2>

<h3>If you&rsquo;re a user</h3>

<p>If you have built any software using the Homebrew-installed GCC, you will need to reinstall that software once the package is updated on the 12th.</p>

<h3>If you provide binary packages built using the Homebrew-installed GCC</h3>

<p>If you provide binary packages that were built using the Homebrew-installed GCC, you should rebuild them using the <a href="https://github.com/Homebrew/homebrew/pull/34303">new formula</a> and have them ready for your users on the 12th.</p>

<h3>If you maintain Homebrew formulae that use GCC/GFortran</h3>

<p>If you maintain Homebrew formulae that build using GCC or GFortran, you should consider <a href="https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Formula-Cookbook.md#formulae-revisions">bumping their revisions</a> on the 12th to ensure that users rebuild them against the new GCC package.</p>

<h2>The tl;dr version</h2>

<p>On December 12, 2014, we will push a new GCC package that changes the install location of libraries. Any software you&rsquo;ve built using the old package (for instance, C++ or Fortran software) will no longer work and will need to be reinstalled. If you build packages for distribution using Homebrew&rsquo;s GCC package, make sure you&rsquo;ve built new versions using our new package and have them ready to distribute at that date.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Thank You, Ada]]></title>
    <link href="http://mistys-internet.website/blog/blog/2014/09/10/thank-you/"/>
    <updated>2014-09-10T08:46:54-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2014/09/10/thank-you</id>
    <content type="html"><![CDATA[<p><a href="http://www.ibiblio.org/bess/">Bess Sadler</a>, <a href="http://andromedayelton.com/">Andromeda Yelton</a>, <a href="http://chrisbourg.wordpress.com/">Chris Bourg</a> and <a href="http://matienzo.org/">Mark Matienzo</a> have stepped forward to pledge to <a href="https://adainitiative.org/donate/?campaign=libraries">match up to $5120 of donations</a> to the <a href="http://adainitiative.org/">Ada Initiative</a>, a non-profit organization that supports the participation of women in open source and culture. I completely support this very generous act; the Ada Initiative does <a href="http://adainitiative.org/what-we-do/">incredibly important</a> work, and I&rsquo;m extremely proud of my friends and of the library community for supporting them.</p>

<p>I&rsquo;ve <a href="http://modelviewculture.com/pieces/there-and-back-again">written before</a> about how I stopped pursuing a career in tech in my late teens. I saw few female (or trans) role models in the tech industry; at a time when my self-image and self-identity was its most fragile, I pivoted away from something I saw as too masculine, without room for me. The Ada Initiative&rsquo;s conferences and advocacy work have done a lot to help make the open tech world a more welcoming space.</p>

<p>There are a lot of reasons why women don&rsquo;t enter, or don&rsquo;t stay, in the tech industry. The last few weeks, when <a href="http://www.theguardian.com/technology/2014/sep/01/how-to-attack-a-woman-who-works-in-video-games">harassment campaigns</a> have <a href="http://www.themarysue.com/gamergate-harms-women/">targeted women to drive them out of the video game industry</a>, have made me reflect on how important it is to work to make online communities and conferences safe spaces.</p>

<p>The Ada Initiative&rsquo;s <a href="http://adainitiative.org/what-we-do/conference-policies/">conference policy advocacy work</a> and their <a href="http://geekfeminism.wikia.com/wiki/Conference_anti-harassment">example anti-harassment policy</a> have been instrumental in helping many organizations and projects adopt their own policies. Both the <a href="https://github.com/code4lib/antiharassment-policy">Code4lib anti-harassment policy</a> and the <a href="https://github.com/Homebrew/homebrew/blob/master/CODEOFCONDUCT.md">Homebrew code of conduct</a>, for example, were inspired by and partially based on the Ada Initiative&rsquo;s work. Seeing organizations adopt these policies has done a lot to make me feel comfortable, and given me confidence that both preventing and dealing with these forms of harassment is something that they see as important. My hope is that future generations of women will feel comfortable entering and interacting in these spaces in ways that others may not have in the past.</p>

<p>In just a few years, the Ada Initiative has helped make sure that these policies are becoming the norm and not the exception for conferences and online communities. I&rsquo;m so grateful we have their advocacy; please consider <a href="https://supportada.org/?campaign=libraries">donating</a> to help them do even more great things.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mind the Dust]]></title>
    <link href="http://mistys-internet.website/blog/blog/2014/09/10/mind-the-dust/"/>
    <updated>2014-09-10T08:42:12-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2014/09/10/mind-the-dust</id>
    <content type="html"><![CDATA[<p>Please excuse the sparseness! I&rsquo;m in the process of migrating from Wordpress to Octopress; I haven&rsquo;t had time to change the default team or migrate over my older posts.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[-no-cpp-precomp: The Compiler Flag That Time Forgot]]></title>
    <link href="http://mistys-internet.website/blog/blog/2013/10/19/no-cpp-precomp-the-compiler-flag-that-time-forgot/"/>
    <updated>2013-10-19T22:58:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2013/10/19/no-cpp-precomp-the-compiler-flag-that-time-forgot</id>
    <content type="html"><![CDATA[<p>I’m often surprised how long software can keep trying to use compatibility features ages after their best-by date.</p>

<p>Now that GCC 4.8 builds on Tiger<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, I’ve been testing as much software with it as I can. When building ncurses using GCC 4.8.1, though, I came across a strange error message:</p>

<blockquote><p>gcc-4.8: error: unrecognized command line option &lsquo;-no-cpp-precomp&rsquo;</p></blockquote>

<p>It built fine with the gcc-4.0 that came with the OS. GCC rarely removes support for flags like this, so I assumed it must be an Apple-only flag. Unfortunately, it wasn’t listed in the manpage at all, and the internet was no help either – the search results were full of users confused about the same build failures, or trying to figure out what it does. All I could find was <a href="http://trac.wxwidgets.org/ticket/14029">confirmation</a> that it’s an obsolete Apple-only flag.</p>

<p>Not finding anything, I decided to find out straight from the horse’s mouth and try source-diving. Luckily Apple publishes the source code for all obsolete versions of their tools at their <a href="http://opensource.apple.com/">Apple Open Source</a> site.</p>

<p>Recent versions of Apple GCC don’t include the flag anywhere in their source. The only place it’s still referenced is in a few configure scripts and changelogs, such as these:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># The spiffy cpp-precomp chokes on some legitimate constructs in GCC</span>
</span><span class='line'><span class="c"># sources; use -no-cpp-precomp to get to GNU cpp.</span>
</span><span class='line'><span class="c"># Apple&#39;s GCC has bugs in designated initializer handling, so disable</span>
</span><span class='line'><span class="c"># that too.</span>
</span><span class='line'><span class="nv">stage1_cflags</span><span class="o">=</span><span class="s2">&quot;-g -no-cpp-precomp -DHAVE_DESIGNATED_INITIALIZERS=0&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In several releases prior to that, for instance <a href="http://opensource.apple.com/source/gcc/gcc-5493/gcc/gcc.c">gcc-5493</a>, the flag is explicitly mentioned as being retained for compatibility and is a no-op:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>/* APPLE LOCAL cpp-precomp compatibility */
</span><span class='line'>%<span class="o">{</span>precomp:%ecpp-precomp not supported<span class="o">}</span>%<span class="o">{</span>no-cpp-precomp:<span class="o">}</span>%<span class="o">{</span>Wno-precomp:<span class="o">}</span><span class="se">\</span>
</span></code></pre></td></tr></table></div></figure>


<p>The last time it was actually documented was in <a href="http://opensource.apple.com/source/gcc/gcc-1765/gcc/doc/install.texi">gcc-1765</a>&rsquo;s install.texi, shipped as a part of the WWDC 2004 Developer Preview of Xcode, which also provides a hint as to what the flag actually did:</p>

<blockquote><p>It’s a good idea to use the GNU preprocessor instead of Apple’s @file{cpp-precomp} during the first stage of bootstrapping; this is automatic when doing @samp{make bootstrap}, but to do it from the toplevel objdir you will need to say @samp{make CC=’cc -no-cpp-precomp’ bootstrap}.</p></blockquote>

<p>So this partially answers our question: Apple shipped an alternate preprocessor, and -no-cpp-precomp triggers the use of the GCC cpp instead. I can only assume this was a leftover that had yet to be excised, because the flag itself was still a no-op at that time. To actually find a version where the flag does something, we have to go all the way back to the December 2002 developer tools, whose <a href="http://opensource.apple.com/source/gcc/gcc-937.2/gcc/gcc.c">gcc-937.2</a> actually has code that uses the flag. This particular build of GCC is Apple’s version of gcc-2.95, and it appears to be the very last where it had any effect. Interestingly, the #ifdef that guards this particular block of code is “#ifdef NEXT_CPP_PRECOMP” – suggesting that this dates back to NeXT, rather than Apple.</p>

<p>To actually find out what this means, O’Reilly’s <a href="http://shop.oreilly.com/product/9780596003562.do">Mac OS X for Unix Geeks</a>, from September 2002, has a nice explanation in chapter 5:</p>

<blockquote><p>Precompiled header files are binary files that have been generated from ordinary C header files and that have been preprocessed and parsed using cpp-precomp. When such a precompiled header is created, both macros and declarations present in the corresponding ordinary header file are sorted, resulting in a faster compile time, a reduced symbol table size, and consequently, faster lookup. Precompiled header files are given a .p extension and are produced from ordinary header files that end with a .h extension.</p></blockquote>

<p>Chapter 4 also provides a nice explanation of why -no-cpp-precomp was desirable:</p>

<blockquote><p>cpp-precomp is faster than cpp. However, some code may not compile with cpp-precomp. In that case, you should invoke cpp by instructing cc not to use cpp-precomp.</p></blockquote>

<p>So there we have it – -no-cpp-precomp became somewhat widely used in Unix software as a compatibility measure to prevent Apple’s cpp-precomp feature from breaking their headers, and has stuck around more than a decade since the last time it’s actually done anything.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>More on that in a future blog post.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Software Archaeology: Apple’s Cctools]]></title>
    <link href="http://mistys-internet.website/blog/blog/2013/04/09/software-archaeology-apples-cctools/"/>
    <updated>2013-04-09T20:08:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2013/04/09/software-archaeology-apples-cctools</id>
    <content type="html"><![CDATA[<p>One of the things I’ve been working on in Tigerbrew is backporting modern Apple build tools. The latest official versions, bundled with Xcode 2.5, are simply too old to be able to build some software. (For example, the latest GCC version available is 4.0.)</p>

<p>In the process, I’ve found some pretty fascinating bits of history littered through the code and makefiles for Apple’s build tools. Here are some findings from Apple’s cctools<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> package:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='make'><span class='line'><span class="c"># MacOS X (the default)</span>
</span><span class='line'><span class="c">#  RC_OS is set to macos (the top level makefile does this)</span>
</span><span class='line'><span class="c">#  RC_CFLAGS needs -D\__KODIAK__ when RC_RELEASE is Kodiak (Public Beta),</span>
</span><span class='line'><span class="c">#      to get the Public Beta directory layout.</span>
</span><span class='line'><span class="c">#  RC_CFLAGS needs -D\__GONZO_BUNSEN_BEAKER__ when RC_RELEASE is Gonzo, </span>
</span><span class='line'><span class="c">#      Bunsen or Beaker to get the old directory layout. </span>
</span><span class='line'><span class="c">#  The code is #ifdef&#39;ed with \__Mach30__ is picked up from &lt;mach/mach.h&gt; </span>
</span><span class='line'><span class="c"># Rhapsody </span>
</span><span class='line'><span class="c">#  RC_OS is set to teflon </span>
</span><span class='line'><span class="c">#  RC_CFLAGS needs the additional flag -D__HERA__ </span>
</span><span class='line'><span class="c"># Openstep</span>
</span><span class='line'><span class="c">#  RC_OS is set to nextstep </span>
</span><span class='line'><span class="c">#  RC_CFLAGS needs the additional flag -D__OPENSTEP__ </span>
</span></code></pre></td></tr></table></div></figure>


<p>This comment from near the top of cctools’s Makefile lists some of the valid build targets, which includes:</p>

<ul>
<li>Kodiak, which was the Mac OS X public beta from September, 2000</li>
<li>Gonzo (Developer Preview 4), Bunsen (Developer Preview 3), and Beaker (PR2)</li>
<li>Rhapsody (internal name for the OS X project as a whole), Hera (Mac OS X Server 1.0, released 1999), and teflon (unknown to me)</li>
<li>OPENSTEP, NeXT’s implementation of their own OpenStep API</li>
</ul>


<p>From further down in the same Makefile:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='make'><span class='line'><span class="cp">ifeq &quot;macos&quot; &quot;$(RC_OS)&quot;</span>
</span><span class='line'>  TRIE :<span class="o">=</span> <span class="k">$(</span>shell <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$(RC_MAJOR_RELEASE_TRAIN)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Tiger&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_MAJOR_RELEASE_TRAIN)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Leopard&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Puma&quot;</span>      <span class="o">]</span>  <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Jaguar&quot;</span>    <span class="o">]</span>  <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Panther&quot;</span>   <span class="o">]</span>  <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;MuonPrime&quot;</span> <span class="o">]</span>  <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;MuonSeed&quot;</span>  <span class="o">]</span>  <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;SUPanWheat&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Tiger&quot;</span> <span class="o">]</span>      <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;SUTiSoho&quot;</span> <span class="o">]</span>   <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Leopard&quot;</span> <span class="o">]</span>    <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Vail&quot;</span> <span class="o">]</span>       <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;SugarBowl&quot;</span> <span class="o">]</span>  <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;BigBear&quot;</span> <span class="o">]</span>    <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Homewood&quot;</span> <span class="o">]</span>   <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Kirkwood&quot;</span> <span class="o">]</span>   <span class="o">||</span> <span class="se">\</span>
</span><span class='line'>             <span class="o">[</span> <span class="s2">&quot;$(RC_RELEASE)&quot;</span> <span class="o">=</span> <span class="s2">&quot;Northstar&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="se">\</span>
</span><span class='line'>                <span class="nb">echo</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span> <span class="se">\ </span>
</span></code></pre></td></tr></table></div></figure>


<p>A lot of familiar cats here, along with a couple of early iOS versions (SugarBowl, BigBear) and a lot of names I’m not familiar with. (Please leave a comment if you have any insight!) As far as I know “Vail” was the Mac LC III from 1993 with no NeXT connection, but I’m sure it must be referring to something else.</p>

<p>From elsewhere in the tree, there’s code to support various CPU architectures. Aside from the usual suspects (PPC, i386), there are some other interesting finds:</p>

<ul>
<li>HP/PA, aka PA-RISC, a CPU family from HP; some versions of NeXTSTEP were shipped for this</li>
<li>i860, an Intel CPU used in the NeXTdimension graphics board for NeXT’s computers</li>
<li>M680000, the classic Motorola CPU family, used in the original NeXT computers</li>
<li>M880000, a Motorola CPU family; NeXT considered using this in their original hardware but never shipped a product using it</li>
<li>SPARC, a CPU family from Sun; some versions of NeXTSTEP were shipped for this</li>
</ul>


<p>I find it fascinating that, even now, cctools still carries the (presumably unmaintained) code for all of these architectures Apple no longer uses.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Apple’s equivalent of binutils.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tiger’s `which` Is Terrible; or, Necessity Is the Mother of Invention]]></title>
    <link href="http://mistys-internet.website/blog/blog/2013/04/04/tigers-which-is-terrible/"/>
    <updated>2013-04-04T07:11:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2013/04/04/tigers-which-is-terrible</id>
    <content type="html"><![CDATA[<p>One of the most useful things about running software in unusual configurations is that sometimes it exposes unexpected flaws you never knew you had.</p>

<p>The <code>which</code> utility is one of those commandline niceties you never really think about until it’s not there anymore. While sometimes implemented as a shell builtin<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, it’s also frequently shipped as a standalone utility. Apple’s modern version, which is part of the shell_utils package and crystallized around Snow Leopard, works like this:</p>

<ul>
<li>If the specified tool is found on the path, prints the path to the first version found (e.g., the one the shell would execute), and exits 0.</li>
<li>If the specified tool isn’t found, prints a newline and exits 1.</li>
</ul>


<p>This version of the tool is really useful in shell scripts to determine a) if a program is present, and b) where it’s located, and until fairly recently Homebrew used it extensively. Unfortunately, early on in my work on Tigerbrew, I discovered that Tiger’s version was… deficient. It works like this:</p>

<ul>
<li>If the specified tool is found on the path, prints the path to the first version found, and exits 0.</li>
<li>If the specified tool isn’t found, prints a verbose message to stdout, and exits 0.</li>
</ul>


<p>The lack of a meaningful exit status and the error message on stdout are both pretty poor behaviour for a CLI app, and broke Homebrew’s assumptions about how it should work.</p>

<p>To work around this, I replaced Homebrew’s wrapper function with a two-line native Ruby method for Tigerbrew, like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">which</span> <span class="n">cmd</span>
</span><span class='line'>  <span class="n">dir</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;PATH&#39;</span><span class="o">].</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span> <span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="no">File</span><span class="o">.</span><span class="n">executable?</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">p</span><span class="p">,</span> <span class="n">cmd</span><span class="p">)}</span>
</span><span class='line'>  <span class="no">Pathname</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">cmd</span><span class="p">))</span> <span class="k">unless</span> <span class="n">dir</span><span class="o">.</span><span class="n">nil?</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As it turns out, not only does it work better on Tiger, but this method is actually faster<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> than shelling out like Homebrew did; process spawning is relatively expensive. As a result, I ended up using the new helper in Homebrew even though it wasn’t strictly necessary.</p>

<p>(And as for the commandline utility, Tigerbrew has a formula for the <a href="https://github.com/mistydemeo/tigerbrew/blob/master/Library/Formula/shell_cmds.rb">shell_cmds</a> collection of utilities.)</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>zsh does; bash doesn’t.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>On the millisecond scale, at least.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Adventures With Ruby 1.8.2]]></title>
    <link href="http://mistys-internet.website/blog/blog/2013/04/02/adventures-with-ruby-1-8-2/"/>
    <updated>2013-04-02T21:59:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2013/04/02/adventures-with-ruby-1-8-2</id>
    <content type="html"><![CDATA[<p>Homebrew has always used the version of Ruby which comes with OS X,<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> a design decision I decided to keep with Tigerbrew. Tiger comes with Ruby 1.8.2, built on Christmas Day, 2004, and with a version of Ruby that old I went in steeling myself for the inevitable ton of compatibility issues.</p>

<p>On the whole I was pleasantly surprised. Most of what Homebrew uses is provided in exactly the same form, and while there are differences that range from puzzling<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> to major<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>, pretty much everything Just Works.</p>

<p>Except, at first, for Pathname. Ruby’s Pathname class, which is an object-oriented wrapper around the File and Dir classes, is at the heart of Homebrew’s file management. The first time I tried to install something with the newborn Tigerbrew, I was quickly treated to a strange exception with an equally mysterious backtrace: <code>Errno::ENOTDIR: Not a directory</code>.</p>

<p>Curious, I dug in. I soon discovered that the bug occurred while Homebrew was unlinking an existing version of a package before beginning to install an upgrade. (For those not in the know, Homebrew installs software into isolated versioned prefixes. The active version of a given package is symlinked into the standard <code>/usr/local</code> locations.) Most of the files were linked and unlinked just fine, but a few files caused the method Pathname#unlink to throw an exception every time. Eventually I noticed a pattern — every symlink that Pathname choked on represented a directory. Once I noticed that, it clicked.</p>

<p>For those who don’t know, symlinks are actually treated on the filesystem level as special files containing their target as text. For most operations, symlinks transparently act as their targets. However, applications which hit the filesystem directly will see them as files — even when they point to directories. Since Pathname handles files and directories differently, handing its instance methods off to File or Dir as appropriate, the bug happened something like this:</p>

<ul>
<li>The #unlink method is called on a Pathname object representing a symlink to a directory.</li>
<li>Pathname examines the object to see if it represents a file or directory, in order to determine whether to call File.unlink or Dir.unlink.</li>
<li>In doing so, Pathname follows the symlink to its target and examines the properties <em>of the target</em>.</li>
<li>Seeing that the target is a directory, Pathname calls Dir.unlink <em>on the original symlink</em>.</li>
<li>Dir.unlink raises <code>Errno::ENOTDIR</code> because, of course, the symlink isn’t a directory.</li>
</ul>


<p>The overridden version of the method can be <a href="https://github.com/mistydemeo/tigerbrew/blob/992ec641652097bb619e9a8de153e436f7dbed16/Library/Homebrew/extend/pathname.rb#L476-L490">found here</a>. The rest of Tigerbrew’s current backports are in Tigerbrew’s file <a href="https://github.com/mistydemeo/tigerbrew/blob/master/Library/Homebrew/extend/tiger.rb">extend/tiger.rb</a>, for the curious.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>For predictability, and so the user doesn’t have to install Ruby before installing Homebrew.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>String’s <code>[]</code> operator always returns the sliced character’s ASCII ordinal, not a string.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>File#flock doesn’t exist in any form.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introducing Tigerbrew]]></title>
    <link href="http://mistys-internet.website/blog/blog/2013/04/01/introducing-tigerbrew/"/>
    <updated>2013-04-01T19:21:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2013/04/01/introducing-tigerbrew</id>
    <content type="html"><![CDATA[<p>Some of you may know that my other gig is <a href="http://brew.sh/">Homebrew</a>, the package manager for Mac OS X. Over the last few months, I’ve been spending some time on a fork of Homebrew that’s starting to become usable enough that I think it’s ready to be announced.</p>

<p>When I was attending the AMIA<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> conference in December, my partner and I were travelling together; while I was at the conference during the day, she worked from various places in Seattle on her laptop. Since it’s practically impossible to attend a modern conference without a laptop, and she uses a desktop at home, I dug out my 2005-era PowerBook G4 to take notes. It may be eight years old, but as soon as I opened it up I remembered why I loved that laptop so much. It’s still in great shape, and it feels like a crime to leave it sitting unused so much of the time.</p>

<p>It’s slow by modern standards, of course, but the thing really keeping it from being usable all the time is software. Apple’s left PowerPC behind as of Mac OS X Leopard<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>, and so have nearly all developers at this point. There are still a few developers carrying the torch (shoutouts to <a href="http://www.floodgap.com/software/tenfourfox">TenFourFox</a>), but as a commandline junkie what I really need is an up-to-date shell[^2] and CLI software<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>. And as big Homebrew fan, as well as a developer, MacPorts just wasn’t going to cut it. <a href="https://github.com/mistydemeo/tigerbrew/">Tigerbrew</a> was born.</p>

<p>The first version of Tigerbrew was pulled together over an evening at the hotel after the first day of the conference, and I’ve been plugging away at it regularly since. At this point I’m proud to say that a significant number of packages build flawlessly,<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup> and thanks to <a href="https://github.com/mistydemeo/tigerbrew/wiki/New-formulae-in-Tigerbrew">some backports</a> from newer versions of OS X<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup> Tigerbrew can supply a much more modern set of essential development tools than Apple provides.</p>

<p>Tigerbrew’s still very much an alpha, and there’s some more work needed until it’s mature, but at this point I consider it ready enough to announce to the world.<sup id="fnref:6"><a href="#fn:6" rel="footnote">6</a></sup> If you have a PowerPC Mac yearning to be used again, why not <a href="https://github.com/mistydemeo/tigerbrew/">give it a go</a>?</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Association of Moving Image Archivists<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>And many hardcore PowerPC users stick with their old Macs for OS 9 compatibility, which was last supported in Tiger.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>bash 2.5 doesn’t cut it.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>Even complex software with a lot of moving parts, like FFmpeg.<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
<li id="fn:5">
<p>I’m very indebted to the MacPorts developers, whose portfiles served as a reference for the buildsystems for several of these.<a href="#fnref:5" rev="footnote">&#8617;</a></p></li>
<li id="fn:6">
<p>Development’s been happening in the public for months, of course, and there are already a few other users out there.<a href="#fnref:6" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PSA: Homebrew-digipres Repository Now Available!]]></title>
    <link href="http://mistys-internet.website/blog/blog/2012/11/21/psa-homebrew-digipres-repository-now-available/"/>
    <updated>2012-11-21T22:13:00-08:00</updated>
    <id>http://mistys-internet.website/blog/blog/2012/11/21/psa-homebrew-digipres-repository-now-available</id>
    <content type="html"><![CDATA[<p>Outside of archivy, I’m also a collaborator on <a href="http://brew.sh">Homebrew</a>, the awesome, lightweight package manager for OS X. I’ve been building a private repository of niche packages which aren’t available in the core repository for some reason or another, and ended up collecting enough digital preservation tools to create a new digital preservation-focused repository. You can find the new homebrew-digipres here: <a href="https://github.com/mistydemeo/homebrew-digipres">https://github.com/mistydemeo/homebrew-digipres</a> I’d welcome any contributions if you want to improve an existing formula, submit updates, or add a new package! Fork away.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[File ID Hackathon Debrief: FITS Handles Video Now!]]></title>
    <link href="http://mistys-internet.website/blog/blog/2012/05/01/file-id-hackathon-debrief-fits-handles-video-now/"/>
    <updated>2012-05-01T22:44:42-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2012/05/01/file-id-hackathon-debrief-fits-handles-video-now</id>
    <content type="html"><![CDATA[<p>I took part in the 24-hour file ID hackathon November 16th. It was a fantastic event, and between us the 15-ish participants got a lot of practical work done. You can read more about it and what was accomplished at the <a href="http://wiki.curatecamp.org/index.php/CURATEcamp_24_hour_worldwide_file_id_hackathon_Nov_16_2012">CURATEcamp wiki</a>.</p>

<p>I spent most of my time working with video content and with <a href="http://fitstool.org/">FITS</a>, the File Identification Tool Set. FITS is a useful tool, but it’s traditionally had some problems that have held it back from being as effective as it could for digital preservation. Aside from its performance, which is an issue that still needs to be addressed, its support for audio-visual material has been pretty poor. I addressed a couple of the more serious items:</p>

<h3>Its embedded Exiftool was badly out of date</h3>

<p>FITS bundles its own versions of the various tools it uses, rather than use the versions installed elsewhere on the machine. In theory this is a good idea; incompatibilities in the tools it uses could subtly break its output. In practice, however, it means that FITS has missed out on a lot of format identification improvements its tools have made. Before the hackathon FITS included exiftool 7.74, which was released in April, 2009. Back then exiftool had only rudimentary video support, but it’s made enormous strides in past several years and now has very robust video metadata extraction. The first thing I did in FITS was update the embedded exiftool to the current release. That alone has made a big difference in format detection.</p>

<p>In the future I think it would be best to rethink the policy of embedding tools rather than using external copies, or at least provide the option to use another version the user has installed. exiftool is updated once every week or two and changes rapidly. I doubt FITS will be updated that frequently. A better option might be to recommend specific known-good versions of tools, but allow the user the option of running whichever tool version they prefer.</p>

<h3>Its metadata mapping for video formats was primitive</h3>

<p>FITS uses XSLT to map metadata fields from their native tag names to its own vocabulary, but the list of tags used for video was very short compared to other formats. As a result, a lot of potentially useful information from exiftool’s output was being discarded. Based on videos in my collection which had extensive embedded metadata, I beefed up FITS’s mapping table to enable it to grab many more common tags.</p>

<p>While this made a good short-term solution, it made me think a bit more about how FITS approaches mapping fields. In particular,</p>

<ol>
<li><p>FITS has separate mappings for types such as “image”, “video”, “audio.” In practice, though, many of these formats use the exact same tags to mean the same things; this means either some mapping logic is duplicated, or certain fields are skipped for some files even though they’re mapped for others. After looking at practical examples of how FITS maps images and videos, I’m not convinced that treating them separately is practical.</p></li>
<li><p>Beyond that, FITS uses file extension to determine whether a file is an image, video, etc. In practice many container file extensions can represent many kinds of files; extension is a pretty fragile way of determining type. If FITS keeps a distinction between file type mappings, it should move to using something like mimetype instead of extension.</p></li>
</ol>


<p>Aside from my work improving FITS, I also submitted a set of Quicktime videos to the OpenPlanets Format Corpus on GitHub. The 61-video set covers almost every codec Apple ships with Quicktime and Final Cut Pro, and should be useful for anyone who wants to try to identify individual codec/container combinations. They’re available at: <a href="https://github.com/openpreserve/format-corpus/tree/master/video/Quicktime">https://github.com/openplanets/format-corpus/tree/master/video/Quicktime</a></p>

<p>I’ll end this off with some eye candy, to show how nicely FITS’s video support has improved.</p>

<p>Before. The video is detected only as “Unknown Binary” (this was sadly common for video), and no meaningful metadata is extracted.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class='line'><span class="nt">&lt;fits</span> <span class="na">xmlns=</span><span class="s">&quot;http://hul.harvard.edu/ois/xml/ns/fits/fits_output&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://hul.harvard.edu/ois/xml/ns/fits/fits_output http://hul.harvard.edu/ois/xml/xsd/fits/fits_output.xsd&quot;</span> <span class="na">version=</span><span class="s">&quot;0.6.1&quot;</span> <span class="na">timestamp=</span><span class="s">&quot;11/17/12 10:18 PM&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;identification</span> <span class="na">status=</span><span class="s">&quot;UNKNOWN&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;identity</span> <span class="na">format=</span><span class="s">&quot;Unknown Binary&quot;</span> <span class="na">mimetype=</span><span class="s">&quot;application/octet-stream&quot;</span> <span class="na">toolname=</span><span class="s">&quot;FITS&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.6.1&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;tool</span> <span class="na">toolname=</span><span class="s">&quot;Jhove&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;1.5&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/identity&gt;</span>
</span><span class='line'><span class="nt">&lt;/identification&gt;</span>
</span><span class='line'><span class="nt">&lt;fileinfo&gt;</span>
</span><span class='line'><span class="nt">&lt;filepath</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>/Users/mistydemeo/Downloads/set1/00000.MTS<span class="nt">&lt;/filepath&gt;</span>
</span><span class='line'><span class="nt">&lt;filename</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>/Users/mistydemeo/Downloads/set1/00000.MTS<span class="nt">&lt;/filename&gt;</span>
</span><span class='line'><span class="nt">&lt;size</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>6039552<span class="nt">&lt;/size&gt;</span>
</span><span class='line'><span class="nt">&lt;md5checksum</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>8c7c728334017a3ab4caff6e78b30037<span class="nt">&lt;/md5checksum&gt;</span>
</span><span class='line'><span class="nt">&lt;fslastmodified</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>1261684470000<span class="nt">&lt;/fslastmodified&gt;</span>
</span><span class='line'><span class="nt">&lt;/fileinfo&gt;</span>
</span><span class='line'><span class="nt">&lt;filestatus</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;metadata</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/fits&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After. Not only is the video format extracted, but a good 18 video tags are extracted.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class='line'><span class="nt">&lt;fits</span> <span class="na">xmlns=</span><span class="s">&quot;http://hul.harvard.edu/ois/xml/ns/fits/fits_output&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://hul.harvard.edu/ois/xml/ns/fits/fits_output http://hul.harvard.edu/ois/xml/xsd/fits/fits_output.xsd&quot;</span> <span class="na">version=</span><span class="s">&quot;0.6.1&quot;</span> <span class="na">timestamp=</span><span class="s">&quot;11/17/12 10:20 PM&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;identification</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;identity</span> <span class="na">format=</span><span class="s">&quot;M2TS&quot;</span> <span class="na">mimetype=</span><span class="s">&quot;video/m2ts&quot;</span> <span class="na">toolname=</span><span class="s">&quot;FITS&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.6.1&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;tool</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/identity&gt;</span>
</span><span class='line'><span class="nt">&lt;/identification&gt;</span>
</span><span class='line'><span class="nt">&lt;fileinfo&gt;</span>
</span><span class='line'><span class="nt">&lt;lastmodified</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>2009:12:24 13:54:36-06:00<span class="nt">&lt;/lastmodified&gt;</span>
</span><span class='line'><span class="nt">&lt;filepath</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>/Users/mistydemeo/Downloads/set1/00001.MTS<span class="nt">&lt;/filepath&gt;</span>
</span><span class='line'><span class="nt">&lt;filename</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>/Users/mistydemeo/Downloads/set1/00001.MTS<span class="nt">&lt;/filename&gt;</span>
</span><span class='line'><span class="nt">&lt;size</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>4552704<span class="nt">&lt;/size&gt;</span>
</span><span class='line'><span class="nt">&lt;md5checksum</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>770fd667d68ca8e6509670b0ef50e61c<span class="nt">&lt;/md5checksum&gt;</span>
</span><span class='line'><span class="nt">&lt;fslastmodified</span> <span class="na">toolname=</span><span class="s">&quot;OIS File Information&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;0.1&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>1261684476000<span class="nt">&lt;/fslastmodified&gt;</span>
</span><span class='line'><span class="nt">&lt;/fileinfo&gt;</span>
</span><span class='line'><span class="nt">&lt;filestatus</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;metadata&gt;</span>
</span><span class='line'><span class="nt">&lt;video&gt;</span>
</span><span class='line'><span class="nt">&lt;digitalCameraManufacturer</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>Sony<span class="nt">&lt;/digitalCameraManufacturer&gt;</span>
</span><span class='line'><span class="nt">&lt;digitalCameraModelName</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>HXR-NX5U<span class="nt">&lt;/digitalCameraModelName&gt;</span>
</span><span class='line'><span class="nt">&lt;duration</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>0.09 s<span class="nt">&lt;/duration&gt;</span>
</span><span class='line'><span class="nt">&lt;imageWidth</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>1920<span class="nt">&lt;/imageWidth&gt;</span>
</span><span class='line'><span class="nt">&lt;imageHeight</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>1080<span class="nt">&lt;/imageHeight&gt;</span>
</span><span class='line'><span class="nt">&lt;videoStreamType</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>DigiCipher II Video<span class="nt">&lt;/videoStreamType&gt;</span>
</span><span class='line'><span class="nt">&lt;shutterSpeedValue</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>1/60<span class="nt">&lt;/shutterSpeedValue&gt;</span>
</span><span class='line'><span class="nt">&lt;apertureSetting</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>Auto<span class="nt">&lt;/apertureSetting&gt;</span>
</span><span class='line'><span class="nt">&lt;fNumber</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>3.7<span class="nt">&lt;/fNumber&gt;</span>
</span><span class='line'><span class="nt">&lt;gain</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>-3 dB<span class="nt">&lt;/gain&gt;</span>
</span><span class='line'><span class="nt">&lt;exposureTime</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>1/60<span class="nt">&lt;/exposureTime&gt;</span>
</span><span class='line'><span class="nt">&lt;exposureProgram</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>Manual<span class="nt">&lt;/exposureProgram&gt;</span>
</span><span class='line'><span class="nt">&lt;whiteBalance</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>Daylight<span class="nt">&lt;/whiteBalance&gt;</span>
</span><span class='line'><span class="nt">&lt;imageStabilization</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>On (0x3f)<span class="nt">&lt;/imageStabilization&gt;</span>
</span><span class='line'><span class="nt">&lt;focus</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>Manual (2.3)<span class="nt">&lt;/focus&gt;</span>
</span><span class='line'><span class="nt">&lt;gpsVersionID</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>2.2.0.0<span class="nt">&lt;/gpsVersionID&gt;</span>
</span><span class='line'><span class="nt">&lt;gpsStatus</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>V<span class="nt">&lt;/gpsStatus&gt;</span>
</span><span class='line'><span class="nt">&lt;gpsMapDatum</span> <span class="na">toolname=</span><span class="s">&quot;Exiftool&quot;</span> <span class="na">toolversion=</span><span class="s">&quot;9.05&quot;</span> <span class="na">status=</span><span class="s">&quot;SINGLE_RESULT&quot;</span><span class="nt">&gt;</span>WGS-84<span class="nt">&lt;/gpsMapDatum&gt;</span>
</span><span class='line'><span class="nt">&lt;/video&gt;</span>
</span><span class='line'><span class="nt">&lt;/metadata&gt;</span>
</span><span class='line'><span class="nt">&lt;/fits&gt;</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Revisiting Archival Description – LOD-LAM Session Idea]]></title>
    <link href="http://mistys-internet.website/blog/blog/2011/05/30/revisiting-archival-description/"/>
    <updated>2011-05-30T15:29:00-07:00</updated>
    <id>http://mistys-internet.website/blog/blog/2011/05/30/revisiting-archival-description</id>
    <content type="html"><![CDATA[<p>Apologies for the brevity of this blog post – I’m keeping this brief to make sure I get it posted before LOD-LAM.</p>

<p>So, archival description.</p>

<p>Archival records are hard to find. They’re often in large bodies of records, difficult to browse through and generally less cut-and-dry than publications which are intended for formal publication and/or public consumption. Archival finding aids are the researcher’s traditional first point of contact, providing background biographical information on the organization and/or personal creator(s), as well as a description of how the records are arranged and description of the various levels of organizational hierarchy. They’re useful!</p>

<p>But they’re also a bit old-fashioned, at least as typically implemented. The finding aid structure imposes a few issues for linked open data applications.</p>

<p>I see two[^1] major problems with current archival description:</p>

<h3>They’re hierarchical</h3>

<p>Most countries’ archival description standards are based on a strict hierarchy from higher levels of description (fonds, etc.) to more precise levels of description (series, sub-series, file, item) with fairly rigidly prescribed relationships between items. The finding aid also assumes a “paper” whole-body approach, rather than a linking approach. This is kind of non-webby, and imposes a stricter order on documents than their creators may have had, in many cases.</p>

<p>(The Australians, of course, are a few steps ahead of the rest of us already.)</p>

<p>Perhaps even more though, a major problem is that:</p>

<h3>They’re imprecise.</h3>

<p>This is the real issue, or at least the most immediate issue. Archival descriptions are designed for human eyes in a paper world, and so they’re often encoded with a level of ambiguity that’s difficult for machines to extract. (<a href="http://archiveshub.ac.uk/blog/?p=2401">LOCAH</a> has been doing a great job of identifying points of concern and trying to route around them.)</p>

<p>Archival descriptions have some inherent ambiguity because interpretation of archival holdings is not always cut and dry, but that doesn’t mean that we have to be ambiguous in how we create those descriptions. We can be precise about the ways in which our collections are ambiguous.</p>

<p>I’d love to get a conversation going about revising descriptive standards to enhance precision in finding aids in order to enhance the ability to use them as computer-readable metadata. I can see a number of areas for improvement:</p>

<ul>
<li>More strongly-typed data fields, rather than “fuzzy” fields that can hold a variety of types of subjectively-defined data</li>
<li>More focus on “globally-scoped” names rather than “locally scoped” (as pointed out by Pete@LOCAH <a href="http://blogs.ukoln.ac.uk/locah/2010/11/16/identifying-the-things-uri-patterns-for-the-hub-linked-data/">here</a>)</li>
<li>A stricter, clearer inheritance model rather than ISAD(G)’s rule of non-repetition (Thanks to Pete <a href="http://web.archive.org/web/20110520025412/http://blogs.ukoln.ac.uk/locah/2010/09/28/model-a-first-cut/">again</a>)</li>
<li>Certainly more, which we can talk about at LOD-LAM!</li>
</ul>


<p>The extent to which all this can be implemented will depend on the organization, of course – retrofitting older archival descriptions for all of this would be time-consuming, if practical at all. But I think there are a lot of benefits to be gained by changing practices going forward, and I see this as an enhancement to current descriptive standards/practices that can benefit more than just linked open data applications.</p>
]]></content>
  </entry>
  
</feed>
